<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=0.8, maximum-scale=0.8">
  <title>Properties - Well-Home Realty</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    html {
      height: 100%;
    }

    body {
      min-height: 100%;
      display: flex;
      flex-direction: column;
      transform: scale(0.9);
      transform-origin: top left;
      width: 111.11%;
    }

    /* Add this - makes the main content grow and pushes footer down */
    body>*:not(footer):not(nav) {
      flex-shrink: 0;
    }
  </style>


</head>

<body class="bg-gray-50">
  <!-- Navigation -->
  <nav class="bg-white shadow-md sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <div class="flex items-center">
          <a href="{% url 'front_page' %}" class="flex items-center gap-2">
            <i class="fas fa-home text-blue-600 text-2xl"></i>
            <span class="text-xl font-bold text-gray-900">Well-Home Realty</span>
          </a>
        </div>
        <div class="hidden md:flex items-center gap-8">
          <a href="{% url 'front_page' %}" class="text-gray-700 hover:text-blue-600 font-medium">Home</a>
          <a href="{% url 'property_page' %}" class="text-gray-700 hover:text-blue-600 font-medium">Properties</a>
          <a href="{% url 'contact_page' %}" class="text-gray-700 hover:text-blue-600 font-medium">Contact</a>

          <!--- <a href="{% url 'admin_login' %}"
            class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">Admin</a> -->
        </div>
        <button class="md:hidden text-gray-700" onclick="toggleMobileMenu()">
          <i class="fas fa-bars text-2xl"></i>
        </button>
      </div>
    </div>
    <!-- Mobile Menu -->
    <div id="mobileMenu" class="hidden md:hidden bg-white border-t">
      <div class="px-4 py-3 space-y-3">
        <a href="{% url 'front_page' %}" class="block text-gray-700 hover:text-blue-600 font-medium">Home</a>
        <a href="{% url 'property_page' %}" class="block text-blue-600 font-medium">Properties</a>
        <a href="{% url 'contact_page' %}" class="block text-gray-700 hover:text-blue-600 font-medium">Contact</a>
        <!--- <a href="{% url 'admin_login' %}"
          class="block bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 text-center">Admin</a> -->
      </div>
    </div>
  </nav>


  <!-- Filters Section -->
  <section class="bg-white py-6 shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Property Type</label>

          <select id="filter-type"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <option value="">All Types</option>
            <option value="House">House</option>
            <option value="Apartment">Apartment</option>
            <option value="Condo">Condo</option>
            <option value="Townhouse">Townhouse</option>
            <option value="Studio">Studio</option>
          </select>


        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>

          <!-- Status -->
          <select id="filter-status"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <option value="">All</option>
            <option value="For Sale">For Sale</option>
            <option value="For Rent">For Rent</option>
          </select>

        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Price Range</label>

          <!-- Price Range -->
          <select id="filter-price"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <option value="">Any Price</option>
            <option value="0-500000">Under $500k</option>
            <option value="500000-1000000">$500k - $1M</option>
            <option value="1000000-2000000">$1M - $2M</option>
            <option value="2000000-">Over $2M</option>
          </select>


        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Bedrooms</label>

          <select id="filter-bedrooms"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <option value="">Any</option>
            <option value="1">1+</option>
            <option value="2">2+</option>
            <option value="3">3+</option>
            <option value="4">4+</option>
          </select>

        </div>
      </div>
      <div class="mt-4 flex justify-between items-center">
        <p class="text-gray-600"><span class="font-semibold">24</span> properties found</p>
        <!-- Apply Filters Button -->
        <button id="apply-filters"
          class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 font-medium">Apply Filters</button>
      </div>
    </div>
  </section>

  <!-- Properties Grid -->
  <section class="py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div id="property-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">



      </div>



      <!-- Pagination Footer -->
      <div class="flex justify-between items-center pt-4 border-t border-gray-200 mt-4">
        <button id="prevBtn" disabled
          class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg shadow-sm hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition">
          ← Previous
        </button>

        <span id="pageCount" class="text-gray-700 font-medium">
          Page <span id="currentPage">1</span> of <span id="totalPages">1</span>
        </span>

        <button id="nextBtn" disabled
          class="px-4 py-2 bg-amber-600 text-white rounded-lg shadow-sm hover:bg-amber-700 disabled:opacity-50 disabled:cursor-not-allowed transition">
          Next →
        </button>

      </div>
  </section>

  <!-- Footer -->
  <footer class="bg-gray-900 text-white py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div>
          <div class="flex items-center gap-2 mb-4">
            <i class="fas fa-home text-blue-400 text-2xl"></i>
            <span class="text-xl font-bold">Well-Home Realty</span>
          </div>
          <p class="text-gray-400">Your trusted partner in finding the perfect home.</p>
        </div>
        <div>
          <h4 class="font-semibold mb-4">Quick Links</h4>
          <ul class="space-y-2 text-gray-400">
            <li><a href="{% url 'front_page' %}" class="hover:text-white">Home</a></li>
            <li><a href="{% url 'property_page' %}" class="hover:text-white">Properties</a></li>
            <li><a href="{% url 'contact_page' %}" class="hover:text-white">Contact</a></li>
          </ul>
        </div>
        <div>
          <h4 class="font-semibold mb-4">Contact</h4>
          <ul class="space-y-2 text-gray-400">
            <li><i class="fas fa-phone mr-2"></i> (555) 123-4567</li>
            <li><i class="fas fa-envelope mr-2"></i> info@WellHome.com</li>
            <li><i class="fas fa-map-marker-alt mr-2"></i> 123 Main St, City</li>
          </ul>
        </div>
        <div>
          <h4 class="font-semibold mb-4">Follow Us</h4>
          <div class="flex gap-4">
            <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-facebook text-2xl"></i></a>
            <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-twitter text-2xl"></i></a>
            <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-instagram text-2xl"></i></a>
          </div>
        </div>
      </div>
      <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
        <p>&copy; 2026 Well-Home Realty. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    function toggleMobileMenu() {
      const menu = document.getElementById('mobileMenu');
      menu.classList.toggle('hidden');
    }
  </script>

  <script>
    let currentPage = 1;
    let totalPages = 1;

    function loadProperties(page = 1, filters = {}) {
      const propertyContainer = document.getElementById('property-container');

      // Build query string from filters
      const params = new URLSearchParams();

      if (filters.property_type) params.append('property_type', filters.property_type);
      if (filters.status) params.append('status', filters.status);
      if (filters.min_price) params.append('min_price', filters.min_price);
      if (filters.max_price) params.append('max_price', filters.max_price);
      if (filters.bedrooms) params.append('bedrooms', filters.bedrooms);

      const queryString = params.toString();
      const url = `http://127.0.0.1:8000/api/property_api_get_clean?page=${page}${queryString ? '&' + queryString : ''}`;

      fetch(url)
        .then(response => {
          if (!response.ok) throw new Error('Network response was not ok');
          return response.json();
        })
        .then(data => {
          propertyContainer.innerHTML = '';

          // Update count display
          document.querySelector('.text-gray-600 .font-semibold').textContent = data.count;

          // Update pagination state
          currentPage = data.current_page;
          totalPages = data.total_pages;

          // Update pagination display
          document.getElementById('currentPage').textContent = currentPage;
          document.getElementById('totalPages').textContent = totalPages;

          // Enable/disable pagination buttons
          const prevBtn = document.getElementById('prevBtn');
          const nextBtn = document.getElementById('nextBtn');

          prevBtn.disabled = currentPage <= 1;
          nextBtn.disabled = currentPage >= totalPages;

          data.results.forEach(property => {
            const card = `
            <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-xl transition-shadow">
             <img
                  src="http://127.0.0.1:8000/media/${property.main_image || '/placeholder.svg?height=200&width=350'}"
                  class="w-full h-36 object-cover"
                />  
              <div class="p-4">
                <div class="flex justify-between items-start mb-2">
                  <h3 class="text-xl font-semibold text-gray-900">${property.title}</h3>
                  <span class="${property.status === 'For Sale' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'} text-xs px-2 py-1 rounded">${property.status}</span>
            
                </div>
                <p class="text-gray-600 text-sm mb-3"><i class="fas fa-map-marker-alt mr-1"></i> ${property.city}, ${property.state}</p>
                <div class="flex gap-4 mb-4 text-sm text-gray-600">
                  <span><i class="fas fa-bed mr-1"></i> ${property.bedrooms} Beds</span>
                  <span><i class="fas fa-bath mr-1"></i> ${property.bathrooms} Baths</span>
                  <span><i class="fas fa-ruler-combined mr-1"></i> ${property.square_feet} sqft</span>
                </div>
                <div class="flex justify-between items-center pt-3 border-t">
                  <span class="text-2xl font-bold text-blue-600">$${Number(property.price).toLocaleString()}</span>
                  <a href="/property/${property.id}/" class="text-blue-600 hover:text-blue-700 font-semibold">View Details →</a>
                </div>
              </div>
            </div>
          `;
            propertyContainer.innerHTML += card;
          });
        })
        .catch(error => {
          console.error('Error fetching properties:', error);
          propertyContainer.innerHTML = '<p class="text-red-500">Failed to load properties.</p>';
        });
    }

    function getFilters() {
      const priceValue = document.getElementById('filter-price').value;
      let minPrice = '';
      let maxPrice = '';

      if (priceValue) {
        const [min, max] = priceValue.split('-');
        minPrice = min || '';
        maxPrice = max || '';
      }

      return {
        property_type: document.getElementById('filter-type').value,
        status: document.getElementById('filter-status').value,
        min_price: minPrice,
        max_price: maxPrice,
        bedrooms: document.getElementById('filter-bedrooms').value
      };
    }

    document.addEventListener('DOMContentLoaded', () => {
      loadProperties();

      document.getElementById('apply-filters').addEventListener('click', () => {
        currentPage = 1; // Reset to page 1 when filters change
        loadProperties(1, getFilters());
      });
    });

    document.getElementById('prevBtn').addEventListener('click', () => {
      if (currentPage > 1) {
        currentPage--;
        loadProperties(currentPage, getFilters());
      }
    });

    document.getElementById('nextBtn').addEventListener('click', () => {
      if (currentPage < totalPages) {
        currentPage++;
        loadProperties(currentPage, getFilters());
      }
    });

  </script>

</body>

</html>